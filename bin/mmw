source $HOME/.config/mmw.config

help(){
  echo "Welcome to MMW"
  echo "Usage: mmw [option]"
  echo "Options: "
  echo "  run 'mmw-config runTests' first "
}

setProj(){
 sed -i "s|PROJ=.*|PROJ=$1|g" $HOME/.config/mmw.config
}

setProjLoc(){
  sed -i "s|PROJLOC=.*|PROJLOC=$1|g" $HOME/.config/mmw.config
}

setArtist(){
  sed -i "s|ARTIST=.*|ARTIST=$1|g" $HOME/.config/mmw.config
}

setTempo(){
  sed -i "s|TEMPO=.*|TEMPO=$1|g" $HOME/.config/mmw.config
}

setStartTime(){
  sed -i "s|START_TIME=.*|START_TIME=$1|g" $HOME/.config/mmw.config
}

setDur(){
  sed -i "s|DUR=.*|DUR=$1|g" $HOME/.config/mmw.config
  sed -i "s|LENGTH=.*|LENGTH=$1|g" $HOME/.config/mmw.config
}

mkProjDir(){
  mkdir $PROJPATH
}

mkStemsDir(){
  mkdir $HOME/audio/$ARTIST/$PROJ/stems
}

displayProj(){
  echo $PROJPATH
}

createProj(){
  if [ -d $HOME/audio/ ]; then
      echo "audio directory exists"
  else
    mkdir -p $HOME/audio/
    echo " audio directory created"
  fi

  if [ -d $PROJLOC ]; then
      echo "Project location directory exists"
  else
    mkdir -p $PROJLOC
    echo " Project location directory created"
  fi

  if [ -d $HOME/audio/$ARTIST ]; then
      echo "Artist directory exists"
  else
    mkdir -p $HOME/audio/$ARTIST;
    echo "Artist directory created"
  fi
  
  if [ -d $PROJPATH ]; then
    echo "Directory exists"
  else
    read -p "$PROJPATH does not exist. Do you want to create it? (y/n): " choice
      if [[ $choice == "y" ]]; then
        mkdir $PROJPATH
        
        mkdir $PROJPATH/score
        mkdir $PROJPATH/.bin
        mkdir $PROJPATH/session
        mkdir $PROJPATH/sound_design
        echo "$PROJ created"
      else
        echo "$PROJ not created"
      fi
   fi

  ffmpeg -f lavfi -i anullsrc=channel_layout=stereo:sample_rate=48000 -t 5 $HOME/audio/$ARTIST/$PROJ/stems/input_1.wav
  if [ ! -d $HOME/audio/$ARTIST/$PROJ ]; then
     mkdir $HOME/audio/$ARTIST/$PROJ
     mkdir $HOME/audio/$ARTIST/$PROJ/stems
  fi
}

getScore(){
  echo $SCORE
}

writeLilyFile(){
touch $HOME/$CORE
cat << EOF > $SCORE
\version "2.22.0"

\header {
  tagline = "Xuuki.xyz"
  title = "Flock"
  composer = "Vyvyan"
}

\score {
  <<
    \new StaffGroup << %Melody
      \new Staff \with  { 
        instrumentName=  " "
        shortInstrumentName= " "
      } 
        \relative {
        \clef percussion
        \time 4/4
        \tempo 4 = 84
      }
    >> 
    \new StaffGroup << %Harmony
      \new Staff \with  
      { 
        instrumentName= "FM"
      } \relative {
        \time 4/4
        \tempo 4 = 84
        \clef bass
        \key a \major 
         <a, e' gis cis>4 r2.
         r4 <a' cis e gis>4 r2
         <cis, gis' b dis>4 r2.
         r4 <cis gis' b e> r8 
         <cis gis' b dis>4 r8
      }
    >> 
    \new StaffGroup << %Bass
       \new Staff \with { 
         instrumentName= " "
         shortInstrumentName= " "}
        \relative  { 
         \time 4/4
         \tempo 4 = 84
         \clef bass
         \key a \major
         a,4\staccato a4\staccato r a4\staccato
         r4 r4 r8 cis8 b4\staccato  
         a4\staccato gis4\staccato r gis4\staccato 
         r fis4\staccato r8 gis4\staccato 
       }
    >>
    \new StaffGroup << %Percussion
       \new Staff \with { %Snare
         instrumentName= " "
         shortInstrumentName= " "
       } 
       {
         \tempo 4 = 84
         \clef percussion
         \xNotesOn
         r2 d4 r8 d
         r2 d4 r4
         r2 d4 r4
         r2 d4 r4
       }

      \new Staff \with { %Brush
        instrumentName= " "
        shortInstrumentName= " "
      } 
      {
        \clef percussion
        \tempo 4 = 84
        \xNotesOn
      }

      \new Staff \with { % HiHat
          instrumentName= "Hi Hat"
          shortInstrumentName= "HH" 
        }
        { 
          \clef percussion
          \tempo 4 = 84
          \xNotesOn
          d4 d d d d d d d 
          d  d d d d d d d   
        }

        \new Staff \with { %Kick
          instrumentName= " "
          shortInstrumentName= " " 
        }
        \relative { 
          \clef percussion
          \tempo 4 = 84
          
        }
    >>
  >>
  \layout {}
  \midi {
    \tempo 4 = 84
  }
}
EOF
}

createScorePDFAndMIDIFiles(){
  lilypond -dmidi-extension=mid --output=$HOME/$PROJLOC/$PROJ $SCORE
}

"$@"
